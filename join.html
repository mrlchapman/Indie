<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Indie's Sentence Building Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Link to shared styles.css -->
<link rel="stylesheet" href="styles.css">
<!-- Add game-specific styles -->
<style>
/* Styles specific to the sentence game */
#image-container {
    text-align: center;
    margin-bottom: 20px;
}
#scrambled-words {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-bottom: 20px;
    gap: 10px;
}
#answer-area {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-bottom: 20px;
    gap: 10px;
}
.word-tile {
    font-size: 24px;
    padding: 10px 15px;
    background-color: #c61190;
    color: white;
    border-radius: 5px;
    cursor: grab;
    user-select: none;
}
.empty-slot {
    width: 100px;
    height: 50px;
    border: 2px dashed #c61190;
    border-radius: 5px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
}
#message {
    font-size: 18px;
    margin-top: 10px;
    color: green;
    text-align: center;
    min-height: 24px;
}
/* Additional styles for buttons */
#button-container {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 20px;
}
#button-container button {
    padding: 10px 20px;
    font-size: 18px;
    background-color: #c61190;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}
#button-container button.hidden {
    display: none;
}
/* Style for the progress bar */
#progress-container {
    width: 100%;
    background-color: #e0e0e0;
    height: 10px;
    margin-bottom: 20px;
}
#progress-bar {
    width: 0%;
    height: 100%;
    background-color: #c61190;
}
</style>
</head>
<body>
<!-- Back to Games Button -->
<a id="back-button" href="https://mrlchapman.github.io/Indie/">‚Üê Back to Games</a>

<div id="game-container">
    <h1>Indie's Sentence Building Game</h1>
    <div id="progress-container">
        <div id="progress-bar"></div>
    </div>
    <div id="image-container">
        <img id="sentence-image" alt="Image representing the sentence" src="" width="300" height="200">
    </div>
    <div id="scrambled-words">
        <!-- Scrambled words will appear here -->
    </div>
    <div id="answer-area">
        <!-- Empty slots will be here -->
    </div>
    <div id="button-container">
        <button id="check-button" onclick="checkSentence()">Check Sentence</button>
        <button id="next-button" class="hidden" onclick="nextSentence()">Next</button>
    </div>
    <div id="message"></div>
    <div id="score">Score: 0</div>
</div>

<!-- Include the sentences array directly in the HTML -->
<script>
let sentences = [
    {
        image: 'https://img.freepik.com/premium-photo/cartoon-tree-with-happy-face_889779-1034.jpg',
        words: ['The', 'tree', 'is', 'tall']
    },
    {
        image: 'https://www.shutterstock.com/image-vector/happy-cute-kid-girl-riding-600nw-1555682591.jpg',
        words: ['The', 'girl', 'rides', 'the', 'bike']
    },
    {
        image: 'https://png.pngtree.com/png-vector/20240316/ourlarge/pngtree-cartoon-dripping-faucet-png-image_11977886.png',
        words: ['The', 'tap', 'is', 'on']
    },
    {
        image: 'https://img.freepik.com/premium-photo/cartoon-beach-scene_889779-1056.jpg',
        words: ['Indie', 'goes', 'to', 'the', 'beach']
    },
    // Add more sentences as desired
];
</script>

<!-- Game script -->
<script>
let currentSentenceIndex = 0;
let score = 0;
let totalSentences = sentences.length;

// Shuffle the sentences to display them in random order
shuffleArray(sentences);

displaySentence();

function displaySentence() {
    const sentenceObj = sentences[currentSentenceIndex];

    // Use the provided words array as the correct order
    sentenceObj.correctOrder = [...sentenceObj.words];

    // Display image
    document.getElementById('sentence-image').src = sentenceObj.image;
    document.getElementById('sentence-image').alt = 'Image representing the sentence';

    // Reset areas
    document.getElementById('scrambled-words').innerHTML = '';
    document.getElementById('answer-area').innerHTML = '';
    document.getElementById('message').textContent = '';
    document.getElementById('next-button').classList.add('hidden');
    document.getElementById('check-button').classList.remove('hidden');
    document.getElementById('check-button').disabled = false;

    // Shuffle words
    const scrambledWords = shuffleArray(sentenceObj.words.slice());

    // Display scrambled words
    let wordTileCounter = 0; // Ensure unique ids
    scrambledWords.forEach((word) => {
        const wordTile = document.createElement('div');
        wordTile.classList.add('word-tile');
        wordTile.textContent = word;
        wordTile.draggable = true;
        wordTile.id = 'word-tile-' + wordTileCounter++;
        wordTile.addEventListener('dragstart', (e) => {
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', wordTile.id);
        });
        wordTile.addEventListener('click', wordTileClick); // Handle tap to move to next slot
        document.getElementById('scrambled-words').appendChild(wordTile);
    });

    // Create empty slots in the answer area
    const answerArea = document.getElementById('answer-area');
    for (let i = 0; i < sentenceObj.words.length; i++) {
        const slot = document.createElement('div');
        slot.classList.add('empty-slot');
        slot.dataset.index = i;
        slot.addEventListener('dragover', dragOver);
        slot.addEventListener('drop', dropWordInSlot);
        answerArea.appendChild(slot);
    }

    updateProgressBar();
}

// Function to handle tapping on a word tile
function wordTileClick(event) {
    const wordTile = event.target;
    const parent = wordTile.parentElement;

    // If the wordTile is in the scrambled-words area
    if (parent && parent.id === 'scrambled-words') {
        const emptySlot = Array.from(document.querySelectorAll('.empty-slot')).find(slot => !slot.firstChild);
        if (emptySlot) {
            emptySlot.appendChild(wordTile);
        }
    }
    // If the wordTile is in a slot, move it back to scrambled-words
    else if (parent && parent.classList.contains('empty-slot')) {
        document.getElementById('scrambled-words').appendChild(wordTile);
    }
}

// Shuffle function
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function dragOver(event) {
    event.preventDefault();
    event.dataTransfer.dropEffect = 'move';
}

function dropWordInSlot(event) {
    event.preventDefault();
    const slot = event.currentTarget;

    const wordTileId = event.dataTransfer.getData('text/plain');
    const wordTile = document.getElementById(wordTileId);

    if (wordTile) {
        const wordTileParent = wordTile.parentElement;

        // If the slot already has a child, move it back to the scrambled words
        if (slot.firstChild) {
            document.getElementById('scrambled-words').appendChild(slot.firstChild);
        }

        // If the word tile came from another slot, empty that slot
        if (wordTileParent && wordTileParent.classList.contains('empty-slot')) {
            wordTileParent.innerHTML = '';
        }

        // Append the word tile to the slot
        slot.appendChild(wordTile);
    }
}

// Function to check the sentence
function checkSentence() {
    const sentenceObj = sentences[currentSentenceIndex];
    const answerWords = Array.from(document.querySelectorAll('.empty-slot')).map(slot => slot.firstChild ? slot.firstChild.textContent : '');

    // Compare answerWords with sentenceObj.correctOrder
    const isCorrect = answerWords.join(' ') === sentenceObj.correctOrder.join(' ');

    const messageElement = document.getElementById('message');
    if (isCorrect) {
        messageElement.textContent = 'Correct!';
        score++;
        document.getElementById('score').textContent = `Score: ${score}`;
    } else {
        messageElement.textContent = 'Try Again!';
    }

    // Disable check button if the answer is correct
    if (isCorrect) {
        document.getElementById('check-button').disabled = true;
        document.getElementById('next-button').classList.remove('hidden');
    }
}

// Function to proceed to the next sentence
function nextSentence() {
    currentSentenceIndex++;
    if (currentSentenceIndex < sentences.length) {
        displaySentence();
    } else {
        // Game over
        alert(`Game over! Your final score is ${score}/${sentences.length}`);
        // Reset game or do something else
        currentSentenceIndex = 0;
        score = 0;
        shuffleArray(sentences);
        displaySentence();
    }
}

// Function to update the progress bar
function updateProgressBar() {
    const progressBar = document.getElementById('progress-bar');
    const progressPercentage = ((currentSentenceIndex) / totalSentences) * 100;
    progressBar.style.width = `${progressPercentage}%`;
}
</script>
</body>
</html>
