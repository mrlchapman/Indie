<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Indie's Sentence Building Game</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Link to shared styles.css (if any) -->
    <!-- <link rel="stylesheet" href="styles.css"> -->
    <!-- Add game-specific styles -->
    <style>
        /* Body styles */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f8ff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh; /* Use min-height instead of height */
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        /* Back to Games Button */
        #back-button {
            font-size: 16px;
            padding: 10px 20px;
            background-color: #c61190;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 20px;
            text-decoration: none;
        }
        #back-button:hover {
            background-color: #a00f7b;
        }

        /* Game Container */
        #game-container {
            background-color: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            text-align: center;
            width: 90%;
            max-width: 600px;
        }

        /* Image Container */
        #image-container {
            width: 100%;
            max-width: 300px;
            height: 200px;
            margin: 0 auto 20px;
            border: 3px solid #c61190;
            border-radius: 10px;
            overflow: hidden;
        }
        #image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Scrambled Words and Answer Area */
        #scrambled-words, #answer-area {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 20px;
            gap: 10px;
        }

        .word-tile, .empty-slot {
            font-size: 24px;
            padding: 10px 15px;
            background-color: #c61190;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            user-select: none;
        }

        .empty-slot {
            width: 100px;
            height: 50px;
            border: 2px dashed #c61190;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background-color: #f9f9f9;
            color: #333;
        }

        /* Button Container */
        #button-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        #button-container button {
            padding: 10px 20px;
            font-size: 18px;
            background-color: #c61190;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #button-container button:hover {
            background-color: #a00f7b;
        }

        #button-container button.hidden {
            display: none;
        }

        /* Message */
        #message {
            font-size: 18px;
            margin-top: 10px;
            color: green;
            text-align: center;
            min-height: 24px;
        }

        /* Score */
        #score {
            font-size: 24px;
            font-weight: bold;
            color: #c61190;
            margin-top: 10px;
        }

        /* Progress Bar */
        #progress-container {
            width: 100%;
            background-color: #e0e0e0;
            height: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
            overflow: hidden;
        }
        #progress-bar {
            width: 0%;
            height: 100%;
            background-color: #c61190;
            transition: width 0.3s;
        }

        /* Animated Tick */
        #tick-container {
            display: none;
            margin: 20px auto;
            width: 100px;
            height: 100px;
        }
        .tick-animate {
            animation: tick-animation 1s forwards;
        }
        @keyframes tick-animation {
            0% {
                stroke-dashoffset: 100;
            }
            100% {
                stroke-dashoffset: 0;
            }
        }

        /* Tick SVG Styles */
        .tick-svg {
            width: 100%;
            height: 100%;
        }
        .tick-svg path {
            stroke: #28a745;
            stroke-width: 5;
            fill: none;
            stroke-dasharray: 100;
            stroke-dashoffset: 100;
            transition: stroke-dashoffset 1s ease;
        }

        /* Result Table */
        #summary-container {
            margin-top: 20px;
        }
        #summary-table {
            width: 100%;
            border-collapse: collapse;
        }
        #summary-table th, #summary-table td {
            border: 1px solid #c61190;
            padding: 8px;
            text-align: left;
        }
        #summary-table th {
            background-color: #c61190;
            color: white;
        }

        /* Responsive Design */
        @media (max-width: 600px) {
            .word-tile, .empty-slot {
                font-size: 20px;
                padding: 8px 12px;
            }

            #button-container button {
                font-size: 16px;
                padding: 8px 16px;
            }

            #score {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Back to Games Button -->
    <a id="back-button" href="https://mrlchapman.github.io/Indie/">‚Üê Back to Games</a>

    <div id="game-container">
        <h1>Indie's Sentence Building Game</h1>
        <div id="progress-container">
            <div id="progress-bar"></div>
        </div>
        <div id="image-container">
            <img id="sentence-image" alt="Image representing the sentence" src="" width="300" height="200">
        </div>
        <div id="scrambled-words">
            <!-- Scrambled words will appear here -->
        </div>
        <div id="answer-area">
            <!-- Empty slots will be here -->
        </div>
        <div id="button-container">
            <button id="check-button" onclick="checkSentence()">Check Sentence</button>
            <button id="next-button" class="hidden" onclick="nextSentence()">Next</button>
        </div>
        <div id="message"></div>
        <div id="tick-container">
            <!-- SVG Tick Animation -->
            <svg class="tick-svg" viewBox="0 0 52 52">
                <path d="M14 27 l7 7 l17-17" />
            </svg>
        </div>
        <div id="score">Score: 0</div>
    </div>

    <!-- Include the sentences array directly in the HTML -->
    <script>
        let sentences = [
            {
                image: 'https://img.freepik.com/premium-photo/cartoon-tree-with-happy-face_889779-1034.jpg',
                words: ['The', 'tree', 'is', 'tall']
            },
            {
                image: 'Images/bike.jpg',
                words: ['Arla', 'rides', 'her', 'bike']
            },
            {
                image: 'https://png.pngtree.com/png-vector/20240316/ourlarge/pngtree-cartoon-dripping-faucet-png-image_11977886.png',
                words: ['The', 'tap', 'is', 'on']
            },
            {
                image: 'Images/Beach.jpg',
                words: ['Indie', 'goes', 'to', 'the', 'beach']
            },
            // Add more sentences as desired
        ];
    </script>

    <!-- Game script -->
    <script>
        let currentSentenceIndex = 0;
        let score = 0;
        let totalSentences = sentences.length;
        let incorrectSentences = []; // To store incorrect sentences

        // Shuffle the sentences to display them in random order
        shuffleArray(sentences);

        displaySentence();

        function displaySentence() {
            const sentenceObj = sentences[currentSentenceIndex];

            // Use the provided words array as the correct order
            sentenceObj.correctOrder = [...sentenceObj.words];

            // Display image
            document.getElementById('sentence-image').src = sentenceObj.image;
            document.getElementById('sentence-image').alt = 'Image representing the sentence';

            // Reset areas
            document.getElementById('scrambled-words').innerHTML = '';
            document.getElementById('answer-area').innerHTML = '';
            document.getElementById('message').textContent = '';
            document.getElementById('message').style.color = 'green'; // Reset message color
            document.getElementById('next-button').classList.add('hidden');
            document.getElementById('check-button').classList.remove('hidden');
            document.getElementById('check-button').disabled = false;

            // Hide and reset tick animation
            const tickContainer = document.getElementById('tick-container');
            tickContainer.style.display = 'none';
            const tickPath = document.querySelector('.tick-svg path');
            tickPath.style.strokeDashoffset = 100;

            // Shuffle words
            const scrambledWords = shuffleArray(sentenceObj.words.slice());

            // Display scrambled words
            scrambledWords.forEach((word) => {
                const wordTile = document.createElement('div');
                wordTile.classList.add('word-tile');
                wordTile.textContent = word;
                wordTile.addEventListener('click', wordTileClick); // Handle tap to move to next slot
                document.getElementById('scrambled-words').appendChild(wordTile);
            });

            // Create empty slots in the answer area
            const answerArea = document.getElementById('answer-area');
            for (let i = 0; i < sentenceObj.words.length; i++) {
                const slot = document.createElement('div');
                slot.classList.add('empty-slot');
                slot.dataset.index = i;
                slot.addEventListener('click', slotClick); // Handle click to move word back up
                answerArea.appendChild(slot);
            }

            updateProgressBar();
        }

        // Function to handle tapping on a word tile
        function wordTileClick(event) {
            const wordTile = event.target;
            const parent = wordTile.parentElement;

            // If the wordTile is in the scrambled-words area
            if (parent && parent.id === 'scrambled-words') {
                const emptySlot = Array.from(document.querySelectorAll('.empty-slot')).find(slot => !slot.firstChild);
                if (emptySlot) {
                    emptySlot.appendChild(wordTile);
                }
            }
        }

        // Function to handle tapping on an empty slot to remove the word
        function slotClick(event) {
            const slot = event.currentTarget;
            if (slot.firstChild) {
                const wordTile = slot.firstChild;
                document.getElementById('scrambled-words').appendChild(wordTile);
            }
        }

        // Shuffle function
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Function to check the sentence
        function checkSentence() {
            const sentenceObj = sentences[currentSentenceIndex];
            const answerWords = Array.from(document.querySelectorAll('.empty-slot')).map(slot => slot.firstChild ? slot.firstChild.textContent : '');

            // Compare answerWords with sentenceObj.correctOrder
            const isCorrect = answerWords.join(' ') === sentenceObj.correctOrder.join(' ');

            const messageElement = document.getElementById('message');
            const tickContainer = document.getElementById('tick-container');
            const tickPath = document.querySelector('.tick-svg path');

            if (isCorrect) {
                messageElement.textContent = 'Correct! Well done!';
                messageElement.style.color = 'green';
                score++;
                document.getElementById('score').textContent = `Score: ${score}`;
                
                // Show and animate tick
                tickContainer.style.display = 'block';
                // Trigger reflow to restart animation
                void tickPath.offsetWidth;
                tickPath.style.strokeDashoffset = 0;
                tickPath.classList.add('tick-animate');
            } else {
                messageElement.textContent = 'Incorrect! üôÅ';
                messageElement.style.color = 'red';
                // Store the incorrect sentence
                incorrectSentences.push({
                    image: sentenceObj.image,
                    correctSentence: sentenceObj.correctOrder.join(' '),
                    yourAnswer: answerWords.join(' ')
                });
            }

            // Disable and hide check button after first attempt
            document.getElementById('check-button').disabled = true;
            document.getElementById('check-button').classList.add('hidden');
            document.getElementById('next-button').classList.remove('hidden');
        }

        // Function to proceed to the next sentence
        function nextSentence() {
            currentSentenceIndex++;
            if (currentSentenceIndex < sentences.length) {
                displaySentence();
            } else {
                endGame();
            }
        }

        // Function to end the game and display results
        function endGame() {
            // Display the sentences the user got wrong
            const gameContainer = document.getElementById('game-container');
            gameContainer.innerHTML = `<h1>Game Over!</h1><p>Your final score is: ${score} out of ${totalSentences}</p>`;

            if (incorrectSentences.length > 0) {
                // Create a table to display incorrect answers
                let resultHTML = `
                    <h2>Review Your Incorrect Sentences:</h2>
                    <table id="summary-table">
                        <tr>
                            <th>Image</th>
                            <th>Correct Sentence</th>
                            <th>Your Answer</th>
                        </tr>
                `;
                incorrectSentences.forEach(item => {
                    resultHTML += `
                        <tr>
                            <td><img src="${item.image}" alt="Sentence Image" width="100"></td>
                            <td>${item.correctSentence}</td>
                            <td>${item.yourAnswer || '(No answer)'}</td>
                        </tr>
                    `;
                });
                resultHTML += `</table>`;
                gameContainer.innerHTML += resultHTML;
            } else {
                gameContainer.innerHTML += `<p>Excellent work! You got all sentences correct! üéâ</p>`;
            }

            gameContainer.innerHTML += `<button onclick="location.reload()">Play Again</button>`;
        }

        // Function to update the progress bar
        function updateProgressBar() {
            const progressBar = document.getElementById('progress-bar');
            const progressPercentage = ((currentSentenceIndex) / totalSentences) * 100;
            progressBar.style.width = `${progressPercentage}%`;
        }
    </script>
</body>
</html>
